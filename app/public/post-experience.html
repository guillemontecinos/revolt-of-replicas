<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>La Revuelta de las Réplicas</title>
    <link rel="stylesheet" href="styles/styles-post-experience.css" />
</head>
<body>
    
</body>
    <div class="post-exp">
        <div class="header">
            <div class="title">
                Gracias por participar!
            </div>
        </div>
        <div class="instructions">
            Contribuye con esta captura de tu interacción al archivo de @larevueltadelasreplicas, ingresando tu nombre o tu @tag de Instagram.
        </div>
        <div class="data">
            <div class="handler-container">
                <input type="text" id="handler" class="handler" placeholder="Nombre o @tag">
            </div>
            <div class="image-container">
                <img src="/reality?id=800">
            </div>
        </div>  
        <div class="election-buttons">
            <button type="button" class="submit-button" id="submit-button">PUBLICAR</button>
            <div class="skip-button">
                <a href="/">Saltar</a>
            </div>
        </div>
    <script>
        let handlerInput = document.getElementById('handler')
        let submitButton = document.getElementById('submit-button')
        
        submitButton.addEventListener('click', postToIg)

        function postToIg() {
            let handler = handlerInput.value
            if(handler.length > 0){
                // TODO: checkear @ y agregar @ a casa amalia
                let comment = 'Contribución de ' + handler + ' para archivo colaborativo de la Revuelta de las Réplicas.'
                let data = JSON.stringify({'comment':comment})
                let xhr = new XMLHttpRequest()
                xhr.open('POST', '/post-to-instagram', true)
                xhr.setRequestHeader("Content-Type", "application/json")
                console.log('post to instagram')
                xhr.send(data)
                setInterval(function () {
                    window.location.href = "/"
                }, 1500)
                
            }
            else {
                handlerInput.placeholder = 'Ingresa nombre o @tag de IG'
            }
        }
    </script>
</html>